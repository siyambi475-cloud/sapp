<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siam Video App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #050505; color: white; font-family: sans-serif; }
        .video-card { transition: transform 0.2s; cursor: pointer; }
        .video-card:active { transform: scale(0.95); }
        iframe { border-radius: 12px; }
    </style>
</head>
<body>

    <div class="max-w-4xl mx-auto p-4">
        <header class="flex justify-between items-center py-6">
            <h1 class="text-3xl font-extrabold text-indigo-500 tracking-tighter">SIAM <span class="text-white">STREAM</span></h1>
        </header>

        <div class="relative mb-8">
            <input type="text" id="searchBox" onkeyup="search()" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." 
                   class="w-full p-4 pl-12 rounded-2xl bg-gray-900 border border-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-600 shadow-xl text-white">
            <span class="absolute left-4 top-4 text-gray-500">üîç</span>
        </div>
        
        <div id="grid" class="grid grid-cols-2 md:grid-cols-3 gap-5">
            </div>
    </div>

    <div id="player" class="hidden fixed inset-0 bg-black/95 flex flex-col items-center justify-center z-50 p-2">
        <div class="w-full max-w-4xl">
            <div class="flex justify-end mb-2">
                <button onclick="closePlayer()" class="bg-red-600 text-white px-6 py-2 rounded-full font-bold shadow-lg hover:bg-red-700 transition">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶® ‚úñ</button>
            </div>
            <div class="relative w-full aspect-video bg-black rounded-2xl overflow-hidden shadow-2xl border border-gray-800">
                <iframe id="videoFrame" 
                        class="absolute inset-0 w-full h-full" 
                        src="" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                        allowfullscreen>
                </iframe>
            </div>
        </div>
    </div>

    <script>
        let allVideos = [];
        // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ø‡¶™‡ßã ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (‡¶§‡¶æ‡¶ú‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡ßá‡¶§‡ßá ‡¶ü‡¶æ‡¶á‡¶Æ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
        const DB_URL = `https://raw.githubusercontent.com/siyambi475-cloud/sapp/main/database.json?t=${new Date().getTime()}`;

        async function loadVideos() {
            try {
                const res = await fetch(DB_URL);
                if (!res.ok) throw new Error("Database load failed");
                allVideos = await res.json();
                display(allVideos);
            } catch (err) {
                document.getElementById('grid').innerHTML = '<p class="text-center col-span-full py-10 text-gray-500">‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ‡•§ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® database.json ‡¶´‡¶æ‡¶á‡¶≤‡ßá ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø [] ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø ‡¶®‡¶æ‡•§</p>';
            }
        }

        function display(data) {
            const grid = document.getElementById('grid');
            if(data.length === 0) {
                grid.innerHTML = '<p class="text-center col-span-full py-10 text-gray-500 font-bold text-lg">‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶®‡ßá‡¶á!</p>';
                return;
            }
            grid.innerHTML = data.map(v => `
                <div onclick="playVideo('${v.url}')" class="video-card bg-gray-900 rounded-2xl overflow-hidden shadow-md hover:shadow-indigo-500/20 border border-gray-800">
                    <div class="relative aspect-video">
                        <img src="${v.thumbnail || 'https://via.placeholder.com/400x225?text=No+Thumbnail'}" 
                             class="w-full h-full object-cover" 
                             alt="${v.title}">
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity bg-black/40">
                             <span class="text-4xl text-white">‚ñ∂Ô∏è</span>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="text-sm font-bold line-clamp-2 leading-tight h-10">${v.title}</h3>
                    </div>
                </div>
            `).reverse().join('');
        }

        function search() {
            const q = document.getElementById('searchBox').value.toLowerCase();
            const filtered = allVideos.filter(v => v.title.toLowerCase().includes(q));
            display(filtered);
        }

        function playVideo(url) {
            const frame = document.getElementById('videoFrame');
            const player = document.getElementById('player');
            
            // ‡¶á‡¶â‡¶ü‡¶ø‡¶â‡¶¨ ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ï‡ßá ‡¶è‡¶Æ‡¶¨‡ßá‡¶° ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ (‡¶Ø‡¶¶‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶≠‡ßÅ‡¶≤ ‡¶•‡¶æ‡¶ï‡ßá)
            let finalUrl = url;
            if (url.includes("youtu.be/")) {
                let id = url.split("youtu.be/")[1].split("?")[0];
                finalUrl = `https://www.youtube.com/embed/${id}?autoplay=1`;
            } else if (url.includes("youtube.com/watch?v=")) {
                let id = url.split("v=")[1].split("&")[0];
                finalUrl = `https://www.youtube.com/embed/${id}?autoplay=1`;
            }

            frame.src = finalUrl;
            player.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closePlayer() {
            const frame = document.getElementById('videoFrame');
            const player = document.getElementById('player');
            frame.src = ""; // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶¨‡ßá
            player.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶≤‡ßá ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá
        loadVideos();
    </script>
</body>
</html>
