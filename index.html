<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siam Video App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .video-card:active { scale: 0.95; }
    </style>
</head>
<body class="bg-black text-white font-sans">
    <div class="p-4 max-w-4xl mx-auto">
        <header class="flex justify-between items-center py-4">
            <h1 class="text-2xl font-black text-indigo-500 italic">SIAM APP</h1>
        </header>

        <input type="text" id="searchBox" onkeyup="search()" placeholder="ভিডিও খুঁজুন..." 
               class="w-full p-4 rounded-xl bg-gray-900 border border-gray-800 focus:outline-indigo-600 mb-6 shadow-2xl">
        
        <div id="grid" class="grid grid-cols-2 md:grid-cols-3 gap-4"></div>
    </div>

    <div id="player" class="hidden fixed inset-0 bg-black/98 flex flex-col items-center justify-center z-50">
        <button onclick="closePlayer()" class="absolute top-5 right-5 bg-white text-black px-5 py-2 rounded-full font-bold shadow-lg">বন্ধ করুন ✖</button>
        <div class="w-full max-w-4xl aspect-video bg-black shadow-2xl border border-gray-800">
            <iframe id="videoFrame" src="" class="w-full h-full" frameborder="0" allowfullscreen referrerpolicy="no-referrer"></iframe>
        </div>
    </div>

    <script>
        let allVideos = [];
        const DB_URL = `https://raw.githubusercontent.com/siyambi475-cloud/sapp/main/database.json?t=${new Date().getTime()}`;

        async function loadVideos() {
            try {
                const res = await fetch(DB_URL);
                allVideos = await res.json();
                display(allVideos);
            } catch (err) { console.error("Data load failed"); }
        }

        function display(data) {
            const grid = document.getElementById('grid');
            if(data.length === 0) {
                grid.innerHTML = '<p class="text-center col-span-2 py-10 text-gray-500">কোনো ভিডিও পাওয়া যায়নি</p>';
                return;
            }
            grid.innerHTML = data.map(v => `
                <div onclick="playVideo('${v.url}')" class="video-card bg-gray-900 rounded-2xl overflow-hidden cursor-pointer shadow-xl transition-all duration-300">
                    <img src="${v.thumbnail}" referrerpolicy="no-referrer" class="w-full h-32 md:h-44 object-cover">
                    <div class="p-3">
                        <h3 class="text-sm font-bold line-clamp-2">${v.title}</h3>
                    </div>
                </div>
            `).reverse().join(''); // নতুন ভিডিও আগে দেখাবে
        }

        function search() {
            const q = document.getElementById('searchBox').value.toLowerCase();
            const filtered = allVideos.filter(v => v.title.toLowerCase().includes(q));
            display(filtered);
        }

        function playVideo(url) {
            document.getElementById('videoFrame').src = url;
            document.getElementById('player').classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // স্ক্রল বন্ধ করবে
        }

        function closePlayer() {
            document.getElementById('videoFrame').src = "";
            document.getElementById('player').classList.add('hidden');
            document.body.style.overflow = 'auto'; // স্ক্রল চালু করবে
        }

        loadVideos();
    </script>
</body>
</html>
